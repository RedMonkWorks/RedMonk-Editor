{"ast":null,"code":"var _jsxFileName = \"D:\\\\Pusher\\\\client\\\\src\\\\App.js\";\nimport React, { Component } from \"react\";\nimport { Controlled as CodeMirror } from \"react-codemirror2\";\nimport Pusher from \"pusher-js\";\nimport pushid from \"pushid\";\nimport axios from \"axios\";\nimport ReactDOM from 'react-dom';\nimport FileBrowser from 'react-keyed-file-browser';\nimport Moment from 'moment';\nimport \"codemirror/lib/codemirror.css\";\nimport \"codemirror/theme/material.css\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/css/css\";\nimport \"codemirror/mode/javascript/javascript\";\nimport \"./App.css\"; // class NestedEditableDemo extends Component {\n//   render() {\n//     return (\n//       <FileBrowser\n//         files={this.state.files}\n//         onCreateFolder={this.handleCreateFolder}\n//         onCreateFiles={this.handleCreateFiles}\n//         onMoveFolder={this.handleRenameFolder}\n//         onMoveFile={this.handleRenameFile}\n//         onRenameFolder={this.handleRenameFolder}\n//         onRenameFile={this.handleRenameFile}\n//         onDeleteFolder={this.handleDeleteFolder}\n//         onDeleteFile={this.handleDeleteFile}\n//       />\n//     )\n//   }\n// }\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      files: [{\n        key: 'index.js',\n        modified: +Moment().subtract(1, 'hours'),\n        size: 1.5 * 1024 * 1024\n      }, {\n        key: 'logo.svg',\n        modified: +Moment().subtract(3, 'days'),\n        size: 545 * 1024\n      }]\n    };\n\n    this.handleCreateFolder = key => {\n      this.setState(state => {\n        state.files = state.files.concat([{\n          key: key\n        }]);\n        return state;\n      });\n    };\n\n    this.handleCreateFiles = (files, prefix) => {\n      this.setState(state => {\n        const newFiles = files.map(file => {\n          let newKey = prefix;\n\n          if (prefix !== '' && prefix.substring(prefix.length - 1, prefix.length) !== '/') {\n            newKey += '/';\n          }\n\n          newKey += file.name;\n          return {\n            key: newKey,\n            size: file.size,\n            modified: +Moment()\n          };\n        });\n        const uniqueNewFiles = [];\n        newFiles.map(newFile => {\n          let exists = false;\n          state.files.map(existingFile => {\n            if (existingFile.key === newFile.key) {\n              exists = true;\n            }\n          });\n\n          if (!exists) {\n            uniqueNewFiles.push(newFile);\n          }\n        });\n        state.files = state.files.concat(uniqueNewFiles);\n        return state;\n      });\n    };\n\n    this.handleRenameFolder = (oldKey, newKey) => {\n      this.setState(state => {\n        const newFiles = [];\n        state.files.map(file => {\n          if (file.key.substr(0, oldKey.length) === oldKey) {\n            newFiles.push({ ...file,\n              key: file.key.replace(oldKey, newKey),\n              modified: +Moment()\n            });\n          } else {\n            newFiles.push(file);\n          }\n        });\n        state.files = newFiles;\n        return state;\n      });\n    };\n\n    this.handleRenameFile = (oldKey, newKey) => {\n      this.setState(state => {\n        const newFiles = [];\n        state.files.map(file => {\n          if (file.key === oldKey) {\n            newFiles.push({ ...file,\n              key: newKey,\n              modified: +Moment()\n            });\n          } else {\n            newFiles.push(file);\n          }\n        });\n        state.files = newFiles;\n        return state;\n      });\n    };\n\n    this.handleDeleteFolder = folderKey => {\n      this.setState(state => {\n        const newFiles = [];\n        state.files.map(file => {\n          if (file.key.substr(0, folderKey.length) !== folderKey) {\n            newFiles.push(file);\n          }\n        });\n        state.files = newFiles;\n        return state;\n      });\n    };\n\n    this.handleDeleteFile = fileKey => {\n      this.setState(state => {\n        const newFiles = [];\n        state.files.map(file => {\n          if (file.key !== fileKey) {\n            newFiles.push(file);\n          }\n        });\n        state.files = newFiles;\n        return state;\n      });\n    };\n\n    this.syncUpdates = () => {\n      const data = { ...this.state\n      };\n      axios.post(\"http://localhost:5000/update-editor\", data).catch(console.error);\n    };\n\n    this.runCode = () => {\n      const {\n        html,\n        css,\n        js\n      } = this.state;\n      const iframe = this.refs.iframe;\n      const document = iframe.contentDocument;\n      const documentContents = `\n      <!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n        <title>Document</title>\n        <style>\n          ${css}\n        </style>\n      </head>\n      <body>\n        ${html}\n\n        <script type=\"text/javascript\">\n          ${js}\n        </script>\n      </body>\n      </html>\n    `;\n      document.open();\n      document.write(documentContents);\n      document.close();\n    };\n\n    this.state = {\n      id: \"\",\n      html: \"\",\n      css: \"\",\n      js: \"\"\n    };\n    this.pusher = new Pusher(\"18160601861a89d7f8f7\", {\n      cluster: \"eu\",\n      forceTLS: true\n    });\n    this.channel = this.pusher.subscribe(\"editor\");\n  }\n\n  componentDidUpdate() {\n    this.runCode();\n  }\n\n  componentDidMount() {\n    this.setState({\n      id: pushid()\n    });\n    this.channel.bind(\"text-update\", data => {\n      const {\n        id\n      } = this.state;\n      if (data.id === id) return;\n      this.setState({\n        html: data.html,\n        css: data.css,\n        js: data.js\n      });\n    });\n  }\n\n  render() {\n    const {\n      html,\n      js,\n      css\n    } = this.state;\n    const codeMirrorOptions = {\n      theme: \"material\",\n      lineNumbers: true,\n      scrollbarStyle: null,\n      lineWrapping: true\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"files\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"title-header\",\n          children: \"FILES\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FileBrowser, {\n          files: this.state.files,\n          onCreateFolder: this.handleCreateFolder,\n          onCreateFiles: this.handleCreateFiles,\n          onMoveFolder: this.handleRenameFolder,\n          onMoveFile: this.handleRenameFile,\n          onRenameFolder: this.handleRenameFolder,\n          onRenameFile: this.handleRenameFile,\n          onDeleteFolder: this.handleDeleteFolder,\n          onDeleteFile: this.handleDeleteFile\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"playground\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"code-editor html-code\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"title-header\",\n            children: \"EDITOR\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CodeMirror, {\n            value: html,\n            options: {\n              mode: \"htmlmixed\",\n              ...codeMirrorOptions\n            },\n            onBeforeChange: (editor, data, html) => {\n              this.setState({\n                html\n              }, () => this.syncUpdates());\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"result\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"title-header\",\n          children: \"RESULT\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"iframe\", {\n          title: \"result\",\n          className: \"iframe\",\n          ref: \"iframe\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["D:/Pusher/client/src/App.js"],"names":["React","Component","Controlled","CodeMirror","Pusher","pushid","axios","ReactDOM","FileBrowser","Moment","App","constructor","state","files","key","modified","subtract","size","handleCreateFolder","setState","concat","handleCreateFiles","prefix","newFiles","map","file","newKey","substring","length","name","uniqueNewFiles","newFile","exists","existingFile","push","handleRenameFolder","oldKey","substr","replace","handleRenameFile","handleDeleteFolder","folderKey","handleDeleteFile","fileKey","syncUpdates","data","post","catch","console","error","runCode","html","css","js","iframe","refs","document","contentDocument","documentContents","open","write","close","id","pusher","cluster","forceTLS","channel","subscribe","componentDidUpdate","componentDidMount","bind","render","codeMirrorOptions","theme","lineNumbers","scrollbarStyle","lineWrapping","mode","editor"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Controlled as CodeMirror } from \"react-codemirror2\";\nimport Pusher from \"pusher-js\";\nimport pushid from \"pushid\";\nimport axios from \"axios\";\nimport ReactDOM from 'react-dom';\n\nimport FileBrowser from 'react-keyed-file-browser';\nimport Moment from 'moment';\n\nimport \"codemirror/lib/codemirror.css\";\nimport \"codemirror/theme/material.css\";\n\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/css/css\";\nimport \"codemirror/mode/javascript/javascript\";\n\nimport \"./App.css\";\n\n\n// class NestedEditableDemo extends Component {\n  \n\n//   render() {\n//     return (\n//       <FileBrowser\n//         files={this.state.files}\n\n//         onCreateFolder={this.handleCreateFolder}\n//         onCreateFiles={this.handleCreateFiles}\n//         onMoveFolder={this.handleRenameFolder}\n//         onMoveFile={this.handleRenameFile}\n//         onRenameFolder={this.handleRenameFolder}\n//         onRenameFile={this.handleRenameFile}\n//         onDeleteFolder={this.handleDeleteFolder}\n//         onDeleteFile={this.handleDeleteFile}\n//       />\n//     )\n//   }\n// }\n\n\nclass App extends Component {\n  state = {\n    files: [\n      {\n        key: 'index.js',\n        modified: +Moment().subtract(1, 'hours'),\n        size: 1.5 * 1024 * 1024,\n      },\n      {\n        key: 'logo.svg',\n        modified: +Moment().subtract(3, 'days'),\n        size: 545 * 1024,\n      },\n    ],\n  }\n\n  handleCreateFolder = (key) => {\n    this.setState(state => {\n      state.files = state.files.concat([{\n        key: key,\n      }])\n      return state\n    })\n  }\n  handleCreateFiles = (files, prefix) => {\n    this.setState(state => {\n      const newFiles = files.map((file) => {\n        let newKey = prefix\n        if (prefix !== '' && prefix.substring(prefix.length - 1, prefix.length) !== '/') {\n          newKey += '/'\n        }\n        newKey += file.name\n        return {\n          key: newKey,\n          size: file.size,\n          modified: +Moment(),\n        }\n      })\n\n      const uniqueNewFiles = []\n      newFiles.map((newFile) => {\n        let exists = false\n        state.files.map((existingFile) => {\n          if (existingFile.key === newFile.key) {\n            exists = true\n          }\n        })\n        if (!exists) {\n          uniqueNewFiles.push(newFile)\n        }\n      })\n      state.files = state.files.concat(uniqueNewFiles)\n      return state\n    })\n  }\n  handleRenameFolder = (oldKey, newKey) => {\n    this.setState(state => {\n      const newFiles = []\n      state.files.map((file) => {\n        if (file.key.substr(0, oldKey.length) === oldKey) {\n          newFiles.push({\n            ...file,\n            key: file.key.replace(oldKey, newKey),\n            modified: +Moment(),\n          })\n        } else {\n          newFiles.push(file)\n        }\n      })\n      state.files = newFiles\n      return state\n    })\n  }\n  handleRenameFile = (oldKey, newKey) => {\n    this.setState(state => {\n      const newFiles = []\n      state.files.map((file) => {\n        if (file.key === oldKey) {\n          newFiles.push({\n            ...file,\n            key: newKey,\n            modified: +Moment(),\n          })\n        } else {\n          newFiles.push(file)\n        }\n      })\n      state.files = newFiles\n      return state\n    })\n  }\n  handleDeleteFolder = (folderKey) => {\n    this.setState(state => {\n      const newFiles = []\n      state.files.map((file) => {\n        if (file.key.substr(0, folderKey.length) !== folderKey) {\n          newFiles.push(file)\n        }\n      })\n      state.files = newFiles\n      return state\n    })\n  }\n  handleDeleteFile = (fileKey) => {\n    this.setState(state => {\n      const newFiles = []\n      state.files.map((file) => {\n        if (file.key !== fileKey) {\n          newFiles.push(file)\n        }\n      })\n      state.files = newFiles\n      return state\n    })\n  }\n\n  constructor() {\n    super();\n    this.state = {\n      id: \"\",\n      html: \"\",\n      css: \"\",\n      js: \"\"\n    };\n\n    this.pusher = new Pusher(\"18160601861a89d7f8f7\", {\n      cluster: \"eu\",\n      forceTLS: true\n    });\n\n    this.channel = this.pusher.subscribe(\"editor\");\n  }\n\n  componentDidUpdate() {\n    this.runCode();\n  }\n\n  componentDidMount() {\n    this.setState({\n      id: pushid()\n    });\n\n    this.channel.bind(\"text-update\", data => {\n      const { id } = this.state;\n      if (data.id === id) return;\n\n      this.setState({\n        html: data.html,\n        css: data.css,\n        js: data.js\n      });\n    });\n  }\n\n  syncUpdates = () => {\n    const data = { ...this.state };\n\n    axios\n      .post(\"http://localhost:5000/update-editor\", data)\n      .catch(console.error);\n  };\n\n  runCode = () => {\n    const { html, css, js } = this.state;\n\n    const iframe = this.refs.iframe;\n    const document = iframe.contentDocument;\n    const documentContents = `\n      <!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n        <title>Document</title>\n        <style>\n          ${css}\n        </style>\n      </head>\n      <body>\n        ${html}\n\n        <script type=\"text/javascript\">\n          ${js}\n        </script>\n      </body>\n      </html>\n    `;\n\n    document.open();\n    document.write(documentContents);\n    document.close();\n  };\n\n  render() {\n    const { html, js, css } = this.state;\n    const codeMirrorOptions = {\n      theme: \"material\",\n      lineNumbers: true,\n      scrollbarStyle: null,\n      lineWrapping: true\n      \n    };\n\n    return (\n      <div className=\"App\">\n        <section className=\"files\">\n          <div className=\"title-header\">FILES</div>\n          <FileBrowser\n            files={this.state.files}\n\n            onCreateFolder={this.handleCreateFolder}\n            onCreateFiles={this.handleCreateFiles}\n            onMoveFolder={this.handleRenameFolder}\n            onMoveFile={this.handleRenameFile}\n            onRenameFolder={this.handleRenameFolder}\n            onRenameFile={this.handleRenameFile}\n            onDeleteFolder={this.handleDeleteFolder}\n            onDeleteFile={this.handleDeleteFile}\n          />\n        </section>\n\n        <section className=\"playground\">\n          <div className=\"code-editor html-code\">\n            <div className=\"title-header\">EDITOR</div>\n            <CodeMirror\n              value={html}\n              options={{\n                mode: \"htmlmixed\",\n                ...codeMirrorOptions\n              }}\n              onBeforeChange={(editor, data, html) => {\n                this.setState({ html }, () => this.syncUpdates());\n              }}\n            />\n          </div>\n          {/* <div className=\"code-editor css-code\">\n            <div className=\"editor-header\">CSS</div>\n            <CodeMirror\n              value={css}\n              options={{\n                mode: \"css\",\n                ...codeMirrorOptions\n              }}\n              onBeforeChange={(editor, data, css) => {\n                this.setState({ css }, () => this.syncUpdates());\n              }}\n            />\n          </div>\n          <div className=\"code-editor js-code\">\n            <div className=\"editor-header\">JavaScript</div>\n            <CodeMirror\n              value={js}\n              options={{\n                mode: \"javascript\",\n                ...codeMirrorOptions\n              }}\n              onBeforeChange={(editor, data, js) => {\n                this.setState({ js }, () => this.syncUpdates());\n              }}\n            />\n          </div> */}\n        </section>\n\n        <section className=\"result\">\n          <div className=\"title-header\">RESULT</div>\n          <iframe title=\"result\" className=\"iframe\" ref=\"iframe\" />\n        </section>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}